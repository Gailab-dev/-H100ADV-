package com.minwon.dao.impl;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.SqlSession;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.minwon.dao.MainDAO;
import com.minwon.vo.ComplaintFileVO;
import com.minwon.vo.ComplaintImageVO;
import com.minwon.vo.ComplaintReplyVO;
import com.minwon.vo.ComplaintSettleVO;
import com.minwon.vo.ComplaintVO;
import com.minwon.vo.IpLogVO;
import com.minwon.vo.MemberVO;
import com.minwon.vo.SearchVO;

@Repository
public class MainDAOImpl implements MainDAO {
	@Autowired
	SqlSession sqlSession;
	
	@Override
	public List<ComplaintVO> getRecentCompletedComplaints(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectList("main.viewRecentCompletedComplaints", map);
	}
	
	@Override
	public List<ComplaintVO> getRecentNonCompletedComplaints(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectList("main.viewRecentNonCompletedComplaints", map);
	}
	
	@Override
	public List<ComplaintVO> getRecentReviewingComplaints(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectList("main.viewRecentReviewingComplaints", map);
	}
	
	@Override
	public List<ComplaintVO> getRecentCooperateComplaints(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectList("main.viewRecentCooperateComplaints", map);
	}
	
	@Override
	public int getChargeOfComplaintsCnt(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectOne("main.chargeOfComplaintsCount", map);
	}

	@Override
	public int getRelatedComplaintsCnt(int dpId, int uId) throws Exception {
		Map<String,Object> map = new HashMap<String,Object>();
		map.put("dpId", dpId);
		map.put("uId", uId);
		return sqlSession.selectOne("main.relatedComplaintsCount", map);
	}
	
	@Override
	public List<ComplaintVO> getRecentCompletedReplies(int dpId) throws Exception {
		return sqlSession.selectList("main.viewRecentCompletedReplies", dpId);
	}

	@Override
	public List<ComplaintVO> getRecentNotCompletedReplies(int dpId) throws Exception {
		return sqlSession.selectList("main.viewRecentNotCompletedReplies", dpId);
	}

	@Override
	public String getDepartment(int dpId) throws Exception {
		return sqlSession.selectOne("main.viewDepartment", dpId);
	}

	@Override
	public List<String> getRelatedDepartments() throws Exception {
		return sqlSession.selectList("main.relatedDepartments");
	}

	@Override
	public void insertComplaint(ComplaintVO vo) {
		sqlSession.insert("main.insertComplaint", vo);
	}

	@Override
	public List<ComplaintVO> getTempComplaints(int uId) throws Exception {
		return sqlSession.selectList("main.viewTempComplaints", uId);
	}

	@Override
	public ComplaintVO getTempComplaint(int cId) throws Exception {
		return sqlSession.selectOne("main.viewTempComplaint", cId);
	}
	
	@Override
	public ComplaintVO getComplaint(int cId) throws Exception {
		return sqlSession.selectOne("main.viewComplaint", cId);
	}

	@Override
	public Integer tempComplaintsCount(int uId) throws Exception {
		return sqlSession.selectOne("main.tempComplaintsCount", uId);
	}

	@Override
	public void updateTempComplaint(ComplaintVO vo) throws Exception {
		sqlSession.update("main.updateComplaint", vo);
	}

	@Override
	public void processComplaint(int cId) throws Exception {
		sqlSession.update("main.processComplaint", cId);
	}

	@Override
	public void deleteComplaint(int cId) throws Exception {
		sqlSession.delete("main.deleteComplaint", cId);
	}

	@Override
	public List<ComplaintVO> getProcessList(SearchVO searchVO) {
		return sqlSession.selectList("main.viewSearchComplaint", searchVO);
	}
	
	@Override
	public int getProcessListCnt(SearchVO searchVO) throws Exception {
		return sqlSession.selectOne("main.viewSearchComplaintCnt", searchVO);
	}

	@Override
	public void updateProcessComplaint(ComplaintVO vo) throws Exception {
		sqlSession.update("main.updateProcess", vo);
	}

	@Override
	public void insertComplaintSettle(ComplaintSettleVO vo) throws Exception {
		sqlSession.insert("main.insertSettle", vo);
	}

	@Override
	public List<ComplaintSettleVO> getComplaintSettles(int cId) throws Exception {
		return sqlSession.selectList("main.viewComplaintSettles", cId);
	}

	@Override
	public void insertComplaintImage(HashMap<String, Object> param) throws Exception {
		sqlSession.insert("main.insertImage", param);
	}

	@Override
	public void insertComplaintReply(ComplaintReplyVO vo) throws Exception {
		sqlSession.insert("main.insertReply", vo);
	}

	@Override
	public List<ComplaintReplyVO> getComplaintReplies(int cId) throws Exception {
		return sqlSession.selectList("main.viewComplaintReplies", cId);
	}

	@Override
	public void completeComplaint(int cId) throws Exception {
		sqlSession.update("main.completeComplaint", cId);
	}

	@Override
	public List<ComplaintVO> getCompletedList(SearchVO searchVO) throws Exception {
		return sqlSession.selectList("main.viewSearchCompleteComplaint", searchVO);
	}
	
	@Override
	public int getCompletedListCnt(SearchVO searchVO) throws Exception {
		return sqlSession.selectOne("main.viewSearchCompleteComplaintCnt", searchVO);
	}

	@Override
	public List<ComplaintImageVO> getComplaintImages(int cId) throws Exception {
		return sqlSession.selectList("main.viewComplaintImages", cId);
	}

	@Override
	public void insertComplaintExcel(ComplaintVO data) throws Exception {
		sqlSession.insert("main.insertComplaintExcel", data);
	}

	@Override
	public List<ComplaintVO> getComplaintsExcel(int uId) throws Exception {
		return sqlSession.selectList("main.viewExcelComplaints", uId);
	}

	@Override
	public List<ComplaintReplyVO> getAllComplaintReplies(SearchVO searchVO) throws Exception {
		return sqlSession.selectList("main.viewAllComplaintReplies", searchVO);
	}

	@Override
	public void insertIpLog(IpLogVO ipLogVO) throws Exception {
		sqlSession.insert("main.insertIpLog", ipLogVO);
	}

	@Override
	public int getAllComplaintRepliesCnt(SearchVO searchVO) throws Exception {
		return sqlSession.selectOne("main.viewAllComplaintRepliesCnt", searchVO);
	}

	@Override
	public void deleteExcelComplaint(int cId) throws Exception {
		sqlSession.delete("main.deleteComplaint", cId);
	}

	@Override
	public void processExcelComplaint(int cId) throws Exception {
		sqlSession.update("main.processExcelComplaint", cId);
	}

	@Override
	public String getDepartmentBoss(int dpId) throws Exception {
		return sqlSession.selectOne("main.getDepartmentBoss", dpId);
	}

	@Override
	public String getParentDepartmentBoss(int dpId) throws Exception {
		return sqlSession.selectOne("main.getParentDepartmentBoss", dpId);
	}

	@Override
	public List<String> getAllDepartments() throws Exception {
		return sqlSession.selectList("main.allDepartments");
	}

	@Override
	public void updateSeparationType(ComplaintVO vo) throws Exception {
		sqlSession.update("main.updateSeparationType", vo);
	}

	@Override
	public void insertComplaintFile(ComplaintFileVO vo) throws Exception {
		sqlSession.insert("main.insertFile", vo);
	}

	@Override
	public List<ComplaintFileVO> getComplaintFiles(Integer complaintId) throws Exception {
		return sqlSession.selectList("main.viewComplaintFiles", complaintId);
	}

	@Override
	public int todayComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.todayComplaintsCount", dpId);
	}

	@Override
	public void registerComplaint(ComplaintVO vo) throws Exception {
		sqlSession.insert("main.registerComplaint", vo);
	}

	@Override
	public int processComplaintCnt(int dpId) throws Exception {
		return sqlSession.selectOne("main.SearchComplaintCnt", dpId);
	}

	@Override
	public int processCompletedComplaintCnt(int dpId) throws Exception {
		return sqlSession.selectOne("main.SearchCompletedComplaintCnt", dpId);
	}

	@Override
	public void requestMember(MemberVO vo) throws Exception {
		sqlSession.insert("main.requestMember", vo);
	}

	@Override
	public int getDpId(String department) throws Exception {
		return sqlSession.selectOne("main.getDpId", department);
	}

	@Override
	public int getPsId(String position) throws Exception {
		return sqlSession.selectOne("main.getPsId", position);
	}

	@Override
	public int getAllListCnt(SearchVO searchVO) throws Exception {
		return sqlSession.selectOne("main.viewAllSearchComplaintCnt", searchVO);
	}

	@Override
	public int allComplaintCnt(int dpId) throws Exception {
		return sqlSession.selectOne("main.allSearchComplaintCnt", dpId);
	}

	@Override
	public List<ComplaintVO> getAllList(SearchVO searchVO) throws Exception {
		return sqlSession.selectList("main.viewAllSearchComplaint", searchVO);
	}

	@Override
	public void updateSettle(ComplaintSettleVO vo) throws Exception {
		sqlSession.update("main.updateSettle", vo);
	}

	@Override
	public void deleteSettle(int id) throws Exception {
		sqlSession.delete("main.deleteSettle", id);
	}

	@Override
	public void deleteImage(int id) throws Exception {
		sqlSession.delete("main.deleteImage", id);
	}

	@Override
	public void deleteFile(int id) throws Exception {
		sqlSession.delete("main.deleteFile", id);
	}

	@Override
	public void deleteReply(int id) throws Exception {
		sqlSession.delete("main.deleteReply", id);
	}

	@Override
	public void updatePlan(ComplaintVO vo) throws Exception {
		sqlSession.update("main.updatePlan", vo);
	}

	@Override
	public void changeProcessClass(ComplaintVO vo) throws Exception {
		sqlSession.update("main.changeProcess", vo);
	}

	@Override
	public int processingComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.processingComplaintsCount", dpId);
	}

	@Override
	public int finishedComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.finishedComplaintsCount", dpId);
	}

	@Override
	public int reviewingComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.reviewingComplaintsCount", dpId);
	}

	@Override
	public int cooperateComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.cooperateComplaintsCount", dpId);
	}

	@Override
	public int impossibleComplaintsCount(int dpId) throws Exception {
		return sqlSession.selectOne("main.impossibleComplaintsCount", dpId);
	}

	@Override
	public List<String> getRelatedDepartments2() throws Exception {
		return sqlSession.selectList("main.relatedDepartments2");
	}
}
